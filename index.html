<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>TON ‚Üí LayerZero</title>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  </head>
  <body>
    <h1>üì° TON ‚Üí LayerZero</h1>
    <div id="ton-connect"></div>
    <button id="send-message">Send LayerZero Message</button>

    <script>
      const connector = new TON_CONNECT_UI.TonConnectUI({
        manifestUrl: "https://ton-layerzero-git-main-helter0s-projects.vercel.app/tonconnect-manifest.json",
        buttonRootId: "ton-connect",
      });

      document.getElementById("send-message").onclick = async () => {
        console.log("üîò –ö–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞");

        // –ü—Ä–æ–≤–µ—Ä–∏–º, –ø–æ–¥–∫–ª—é—á—ë–Ω –ª–∏ –∫–æ—à–µ–ª—ë–∫
        const wallet = await connector.wallet;
        if (!wallet) {
          alert("‚ùå –°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª—ë–∫ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ");
          return;
        }

        console.log("‚úÖ –ö–æ—à–µ–ª—ë–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω:", wallet.account.address);

        // –¢–≤–æ–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç
        const address = "EQDF40kcwCXAfquLxsX4z_J9FmikzLak-kBOABkA1FPqcFnD";

        // Base64 payload (–ø—Ä–∏–º–µ—Ä - –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π)
        const payload = {
          type: "payload",
          data: "QnV5Cm5vbmNlIDEKdG9rZW4gQlFYMWNqY1JIWG1ycU50b0ZXd21FNWJaajdSUG5lVG1xWEI5NzliMnB1bXAKYW1vdW50IDE=" // –∑–∞–º–µ–Ω–∏ –Ω–∞ –Ω—É–∂–Ω—ã–π payload –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
        };

        const transaction = {
          validUntil: Math.floor(Date.now() / 1000) + 60,
          messages: [
            {
              address,
              amount: "100000000", // 0.1 TON
              payload
            }
          ]
        };

        try {
          console.log("üì® –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:", transaction);
          await connector.sendTransaction(transaction);
          console.log("‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!");
        } catch (error) {
          console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:", error);
          alert("–û—à–∏–±–∫–∞: " + (error.message || error));
        }
      };
    </script>
  </body>
</html>
